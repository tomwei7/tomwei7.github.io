<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Golangçš„åˆ‡ç‰‡ç±»å‹æä¾›äº†ä¸€ç§ç®€å•é«˜æ•ˆçš„æ“ä½œåºåˆ—åŒ–ç±»å‹æ•°æ®çš„æ–¹å¼ã€‚åˆ‡ç‰‡å’Œå…¶ä»–è¯­è¨€ä¸­çš„æ•°ç»„ç±»ä¼¼ï¼Œä¸è¿‡å«æœ‰ä¸€äº›ç‰¹æ®Šçš„å±æ€§"><title>Golangåˆ‡ç‰‡ä½¿ç”¨ä¸å†…éƒ¨å®ç°(ç¿»è¯‘)</title><link rel=canonical href=https://tomwei7.com/2016/12/27/go-slices-usage-and-internals.html><link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="Golangåˆ‡ç‰‡ä½¿ç”¨ä¸å†…éƒ¨å®ç°(ç¿»è¯‘)"><meta property="og:description" content="Golangçš„åˆ‡ç‰‡ç±»å‹æä¾›äº†ä¸€ç§ç®€å•é«˜æ•ˆçš„æ“ä½œåºåˆ—åŒ–ç±»å‹æ•°æ®çš„æ–¹å¼ã€‚åˆ‡ç‰‡å’Œå…¶ä»–è¯­è¨€ä¸­çš„æ•°ç»„ç±»ä¼¼ï¼Œä¸è¿‡å«æœ‰ä¸€äº›ç‰¹æ®Šçš„å±æ€§"><meta property="og:url" content="https://tomwei7.com/2016/12/27/go-slices-usage-and-internals.html"><meta property="og:site_name" content="å›´åŸ"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="golang"><meta property="article:published_time" content="2016-12-27T00:00:00+00:00"><meta property="article:modified_time" content="2016-12-27T00:00:00+00:00"><meta property="og:image" content="https://tomwei7.com/2016/12/27/go-slices-usage-and-internals/golang-arrays-and-slices.png"><meta name=twitter:title content="Golangåˆ‡ç‰‡ä½¿ç”¨ä¸å†…éƒ¨å®ç°(ç¿»è¯‘)"><meta name=twitter:description content="Golangçš„åˆ‡ç‰‡ç±»å‹æä¾›äº†ä¸€ç§ç®€å•é«˜æ•ˆçš„æ“ä½œåºåˆ—åŒ–ç±»å‹æ•°æ®çš„æ–¹å¼ã€‚åˆ‡ç‰‡å’Œå…¶ä»–è¯­è¨€ä¸­çš„æ•°ç»„ç±»ä¼¼ï¼Œä¸è¿‡å«æœ‰ä¸€äº›ç‰¹æ®Šçš„å±æ€§"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tomwei7.com/2016/12/27/go-slices-usage-and-internals/golang-arrays-and-slices.png"><link rel="shortcut icon" href=/favicon.ico><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-72226462-1','auto'),ga('send','pageview'))</script></head><body class="article-page has-toc"><script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script><div class="container main-container flex
extended"><div id=article-toolbar><a href=/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg><span>è¿”å›</span></a></div><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/2016/12/27/go-slices-usage-and-internals.html><img src=/2016/12/27/go-slices-usage-and-internals/golang-arrays-and-slices_huf1feef2c1c7ed33d31f21b0790e5139e_26614_800x0_resize_box_2.png srcset="/2016/12/27/go-slices-usage-and-internals/golang-arrays-and-slices_huf1feef2c1c7ed33d31f21b0790e5139e_26614_800x0_resize_box_2.png 800w, /2016/12/27/go-slices-usage-and-internals/golang-arrays-and-slices_huf1feef2c1c7ed33d31f21b0790e5139e_26614_1600x0_resize_box_2.png 1600w" width=800 height=367 loading=lazy alt="Featured image of post Golangåˆ‡ç‰‡ä½¿ç”¨ä¸å†…éƒ¨å®ç°(ç¿»è¯‘)"></a></div><div class=article-details><header class=article-category><a href=/categories/golang.html>golang</a>
<a href=/categories/translate.html>translate</a></header><h2 class=article-title><a href=/2016/12/27/go-slices-usage-and-internals.html>Golangåˆ‡ç‰‡ä½¿ç”¨ä¸å†…éƒ¨å®ç°(ç¿»è¯‘)</a></h2><h3 class=article-subtitle>Golangçš„åˆ‡ç‰‡ç±»å‹æä¾›äº†ä¸€ç§ç®€å•é«˜æ•ˆçš„æ“ä½œåºåˆ—åŒ–ç±»å‹æ•°æ®çš„æ–¹å¼ã€‚åˆ‡ç‰‡å’Œå…¶ä»–è¯­è¨€ä¸­çš„æ•°ç»„ç±»ä¼¼ï¼Œä¸è¿‡å«æœ‰ä¸€äº›ç‰¹æ®Šçš„å±æ€§</h3><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Dec 27, 2016</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>é˜…è¯»æ—¶é•¿: 6 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p>Golangçš„åˆ‡ç‰‡ç±»å‹æä¾›äº†ä¸€ç§ç®€å•é«˜æ•ˆçš„æ“ä½œåºåˆ—åŒ–ç±»å‹æ•°æ®çš„æ–¹å¼ã€‚åˆ‡ç‰‡å’Œå…¶ä»–è¯­è¨€ä¸­çš„æ•°ç»„ç±»ä¼¼ï¼Œä¸è¿‡å«æœ‰ä¸€äº›ç‰¹æ®Šçš„å±æ€§ã€‚è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å°±æ¥çœ‹ä¸€ä¸‹ä»€ä¹ˆæ˜¯åˆ‡ç‰‡å’Œå¦‚ä½•ä½¿ç”¨åˆ‡ç‰‡</p><h3 id=æ•°ç»„>æ•°ç»„</h3><p>åˆ‡ç‰‡ç±»å‹æ˜¯å»ºç«‹åœ¨æ•°ç»„ç±»å‹ä¸Šçš„æŠ½è±¡ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬äº†è§£åˆ‡ç‰‡ä¹‹å‰æˆ‘ä»¬å¿…é¡»å…ˆäº†è§£æ•°ç»„ã€‚</p><p>æ•°ç»„ç±»å‹å®šä¹‰äº†ä¸€ç§ç‰¹å®šé•¿åº¦å’Œå…ƒç´ çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œ<code>[4]int </code>ä»£è¡¨äº†æœ‰å››ä¸ª<code>int</code>å…ƒç´ çš„æ•°ç»„ã€‚æ•°ç»„çš„å¤§å°æ˜¯å›ºå®šçš„ï¼›å®ƒçš„å¤§å°æ˜¯å®ƒç±»å‹çš„ä¸€éƒ¨åˆ†ï¼ˆ<code>[4]int</code>å’Œ<code>[5]int</code>æ˜¯ä¸åŒçš„ï¼Œä¸å…¼å®¹çš„ç±»å‹ï¼‰ã€‚æ•°ç»„å¯ä»¥ç›´æ¥å®šä½ï¼Œè¡¨è¾¾å¼<code>s[n]</code>å¯ä»¥ç›´æ¥è®¿é—®ç¬¬nä¸ªå…ƒç´ ï¼Œä»é›¶å¼€å§‹ã€‚</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> [<span style=color:#ae81ff>4</span>]<span style=color:#66d9ef>int</span>
<span style=color:#a6e22e>a</span>[<span style=color:#ae81ff>0</span>] = <span style=color:#ae81ff>1</span>
<span style=color:#a6e22e>i</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>a</span>[<span style=color:#ae81ff>0</span>]
<span style=color:#75715e>// i == 1
</span></code></pre></div><p>æ•°ç»„ä¸éœ€è¦æ˜¾å¼çš„åˆå§‹åŒ–ï¼›ä¸€ä¸ªé›¶å€¼çš„æ•°ç»„å¯ä»¥è¢«ä½¿ç”¨ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ æ˜¯ä»–ä»¬è‡ªå·±æœ¬èº«çš„é›¶å€¼(<a class=link href=https://golang.org/ref/spec#The_zero_value target=_blank rel=noopener>golangé›¶å€¼å‚è€ƒè¿™é‡Œ</a>)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// a[2] == 0, the zero value of the int type
</span></code></pre></div><p>åœ¨å†…å­˜ä¸­ä»£è¡¨<code>[4]int</code>å°±æ˜¯4ä¸ªæ•´å½¢çš„å€¼é¡ºåºæ’åˆ—</p><p><figure class=gallery-image style=flex-grow:760;flex-basis:1824px><a href=/2016/12/27/go-slices-usage-and-internals/go-slices-usage-and-internals_slice-array.png data-size=517x68><img src=/2016/12/27/go-slices-usage-and-internals/go-slices-usage-and-internals_slice-array.png width=517 height=68 srcset="/2016/12/27/go-slices-usage-and-internals/go-slices-usage-and-internals_slice-array_hu5a3110f7f8a91ffcff07d25db842332b_1237_480x0_resize_box_2.png 480w, /2016/12/27/go-slices-usage-and-internals/go-slices-usage-and-internals_slice-array_hu5a3110f7f8a91ffcff07d25db842332b_1237_1024x0_resize_box_2.png 1024w" loading=lazy></a></figure></p><p>Golang ä¸­æ•°ç»„æ˜¯ä¸ªå€¼ã€‚æ•°ç»„çš„å˜é‡ä»£è¡¨ç€æ•´ä¸ªæ•°ç»„ï¼›è€Œä¸æ˜¯æŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼ˆè¿™ä¸ªå’ŒCè¯­è¨€ä¸­çš„æƒ…å†µä¸åŒï¼‰ã€‚è¿™ä»£è¡¨è¿™å½“ä½ åˆ†é…æˆ–è€…ä¼ é€’æ•°ç»„å˜é‡æ—¶å°†ä¼šæ‹·è´æ•´ä¸ªæ•°ç»„çš„å†…å®¹ã€‚ï¼ˆä¸ºäº†é¿å…å¤åˆ¶ä½ å¯ä»¥ä¼ é€’ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆï¼Œä¸è¿‡è¿™æ—¶è¿™å°±æ˜¯æ•°ç»„çš„æŒ‡é’ˆè€Œä¸æ˜¯æ•°ç»„äº†ã€‚ï¼‰ä½ å¯ä»¥æŠŠæ•°ç»„æƒ³æˆä¸€ç§ç»“æ„ä½“ä½†å…·æœ‰ç´¢å¼•è€Œä¸æ˜¯å‘½åå­—æ®µçš„å›ºå®šå¤§å°çš„å¤åˆå€¼ã€‚</p><p>ä¸€ä¸ªæ•°ç»„å¯ä»¥è¿™æ ·æŒ‡å®šï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>b</span> <span style=color:#f92672>:=</span> [<span style=color:#ae81ff>2</span>]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;Penn&#34;</span>, <span style=color:#e6db74>&#34;Teller&#34;</span>}
</code></pre></div><p>æˆ–è€…ï¼Œä½ å¯ä»¥è®©ç¼–è¯‘å™¨ä¸ºä½ è®¡ç®—æ•°ç»„å…ƒç´ ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>b</span> <span style=color:#f92672>:=</span> [<span style=color:#f92672>...</span>]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;Penn&#34;</span>, <span style=color:#e6db74>&#34;Teller&#34;</span>}
</code></pre></div><p>åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œ<code>b</code>çš„ç±»å‹éƒ½æ˜¯<code>[2]string</code></p><h3 id=åˆ‡ç‰‡>åˆ‡ç‰‡</h3><p>æ•°ç»„æœ‰å®ƒçš„ä½œç”¨ï¼Œä½†æ˜¯å®ƒä¸å¤Ÿçµæ´»ï¼Œæ‰€ä»¥ä½ ç»å¸¸åœ¨golang çš„ä»£ç ä¸­è§åˆ°å®ƒã€‚åˆ‡ç‰‡ï¼Œåˆ°å¤„éƒ½æœ‰ã€‚åˆ‡ç‰‡å»ºç«‹åœ¨æ•°ç»„çš„åŸºç¡€ä¸Šä¸”æ›´åŠ çš„å¼ºå¤§çµæ´»ã€‚</p><p><code>[]T</code>æ˜¯åˆ‡ç‰‡ç±»å‹çš„å®šä¹‰ï¼Œå…¶ä¸­<code>T</code>æ˜¯åˆ‡ç‰‡ä¸­å…ƒç´ çš„ç±»å‹ï¼Œè·Ÿæ•°ç»„ä¸åŒï¼Œåˆ‡ç‰‡ç±»å‹æ²¡æœ‰é•¿åº¦ã€‚</p><p>å£°æ˜ä¸€ä¸ªåˆ‡ç‰‡å’Œå£°æ˜ä¸€ä¸ªæ•°ç»„æœ‰ç‚¹åƒï¼Œé™¤äº†ä¸éœ€è¦æŒ‡å®šå…ƒç´ ä¸ªæ•°</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>letters</span> <span style=color:#f92672>:=</span> []<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;a&#34;</span>, <span style=color:#e6db74>&#34;b&#34;</span>, <span style=color:#e6db74>&#34;c&#34;</span>, <span style=color:#e6db74>&#34;d&#34;</span>}
</code></pre></div><p>ä¸€ä¸ªåˆ‡ç‰‡å¯ä»¥ç”±å†…ç½®çš„<code>make</code>å‡½æ•°åˆ›å»º</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> make([]<span style=color:#a6e22e>T</span>, <span style=color:#a6e22e>len</span>, <span style=color:#a6e22e>cap</span>) []<span style=color:#a6e22e>T</span>
</code></pre></div><p>å…¶ä¸­<code>T</code>ä»£è¡¨è¦åˆ›å»ºçš„åˆ‡ç‰‡å…¶ä¸­å…ƒç´ çš„ç±»å‹ï¼Œ<code>make</code>å‡½æ•°æ¥å—ç±»å‹ã€é•¿åº¦å’Œå®¹é‡é€‰é¡¹ã€‚è°ƒç”¨æ—¶ï¼Œ<code>make</code>åˆ†é…ä¸€ä¸ªæ•°ç»„å’Œè¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥æ•°ç»„çš„åˆ‡ç‰‡</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>s</span> []<span style=color:#66d9ef>byte</span>
<span style=color:#a6e22e>s</span> = make([]<span style=color:#66d9ef>byte</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>)
<span style=color:#75715e>// s == []byte{0, 0, 0, 0, 0}
</span></code></pre></div><p>å½“å®¹é‡å‚æ•°çœç•¥æ—¶ï¼Œé»˜è®¤å€¼ç­‰äºæŒ‡å®šçš„é•¿åº¦ã€‚è¿™ä¸ªæœ‰ä¸ªæ›´åŠ ç®€æ´ç‰ˆæœ¬çš„ä»£ç ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>s</span> <span style=color:#f92672>:=</span> make([]<span style=color:#66d9ef>byte</span>, <span style=color:#ae81ff>5</span>)
</code></pre></div><p>å¯ä»¥ä½¿ç”¨å†…ç½®çš„<code>len</code>å’Œ<code>cap</code>è·å–åˆ‡ç‰‡çš„é•¿åº¦å’Œå®¹é‡</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go>len(<span style=color:#a6e22e>s</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>5</span>
cap(<span style=color:#a6e22e>s</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>5</span>
</code></pre></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹åˆ‡ç‰‡é•¿åº¦ä¸å®¹é‡ç›´æ¥çš„å…³ç³»</p><p>é›¶å€¼çš„åˆ‡ç‰‡æ˜¯<code>nil</code>ã€‚<code>nil</code>çš„åˆ‡ç‰‡<code>len</code>å’Œ<code>cap</code>å‡½æ•°éƒ½ä¼šè¿”å›0ã€‚</p><p>è¿˜å¯ä»¥é€šè¿‡åˆ‡ç‰‡ç°æœ‰çš„åˆ‡ç‰‡æˆ–è€…æ•°ç»„æ¥ç”Ÿæˆåˆ‡ç‰‡ã€‚åˆ‡ç‰‡é€šè¿‡æŒ‡å®šå…·æœ‰ä¸¤ä¸ªç”¨å†’å·åˆ†éš”çš„ç´¢å¼•çš„åŠå¼€èŒƒå›´æ¥å®Œæˆã€‚æ¯”å¦‚ï¼Œè¡¨è¾¾å¼<code>b[1:4]</code>åˆ›å»ºäº†ä¸€ä¸ªåˆ‡ç‰‡åŒ…å«äº†<code>b</code>ä¸­1åˆ°3çš„å…ƒç´ ï¼ˆå¾—å¸¦çš„åˆ‡ç‰‡çš„ç´¢å¼•æ˜¯0åˆ°2ï¼‰ã€‚</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>b</span> <span style=color:#f92672>:=</span> []<span style=color:#66d9ef>byte</span>{<span style=color:#e6db74>&#39;g&#39;</span>, <span style=color:#e6db74>&#39;o&#39;</span>, <span style=color:#e6db74>&#39;l&#39;</span>, <span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;n&#39;</span>, <span style=color:#e6db74>&#39;g&#39;</span>}
<span style=color:#75715e>// b[1:4] == []byte{&#39;o&#39;, &#39;l&#39;, &#39;a&#39;}, sharing the same storage as b
</span></code></pre></div><p>åˆ‡ç‰‡è¡¨è¾¾å¼çš„å¼€å§‹å’Œç»“æŸç´¢å¼•æ˜¯å¯é€‰çš„;å®ƒä»¬åˆ†åˆ«é»˜è®¤ä¸ºé›¶å’Œåˆ‡ç‰‡çš„é•¿åº¦ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// b[:2] == []byte{&#39;g&#39;, &#39;o&#39;}
</span><span style=color:#75715e>// b[2:] == []byte{&#39;l&#39;, &#39;a&#39;, &#39;n&#39;, &#39;g&#39;}
</span><span style=color:#75715e>// b[:] == b
</span></code></pre></div><p>é€šè¿‡æ•°ç»„åˆ›å»ºåˆ‡ç‰‡çš„è¯­æ³•ä¹Ÿä¸€æ ·ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>x</span> <span style=color:#f92672>:=</span> [<span style=color:#ae81ff>3</span>]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;Ğ›Ğ°Ğ¹ĞºĞ°&#34;</span>, <span style=color:#e6db74>&#34;Ğ‘ĞµĞ»ĞºĞ°&#34;</span>, <span style=color:#e6db74>&#34;Ğ¡Ñ‚Ñ€ĞµĞ»ĞºĞ°&#34;</span>}
<span style=color:#a6e22e>s</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>x</span>[:] <span style=color:#75715e>// a slice referencing the storage of x
</span></code></pre></div><h3 id=åˆ‡ç‰‡å†…éƒ¨>åˆ‡ç‰‡å†…éƒ¨</h3><p>åˆ‡ç‰‡æ˜¯æ•°ç»„æ®µçš„æè¿°ç¬¦ã€‚å®ƒç”±æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆï¼Œæ®µçš„é•¿åº¦åŠå…¶å®¹é‡ï¼ˆæ®µçš„æœ€å¤§é•¿åº¦ï¼‰ç»„æˆã€‚</p><p><figure class=gallery-image style=flex-grow:261;flex-basis:626px><a href=/2016/12/27/go-slices-usage-and-internals/go-slices-usage-and-internals_slice-struct.png data-size=517x198><img src=/2016/12/27/go-slices-usage-and-internals/go-slices-usage-and-internals_slice-struct.png width=517 height=198 srcset="/2016/12/27/go-slices-usage-and-internals/go-slices-usage-and-internals_slice-struct_huc8289134f44b8d2e744099b8c1f2005a_3650_480x0_resize_box_2.png 480w, /2016/12/27/go-slices-usage-and-internals/go-slices-usage-and-internals_slice-struct_huc8289134f44b8d2e744099b8c1f2005a_3650_1024x0_resize_box_2.png 1024w" loading=lazy></a></figure></p><p>æˆ‘ä»¬å…ˆå‰ç”±<code>make([]byte,5)</code>åˆ›å»ºçš„å˜é‡<code>s</code>çš„ç»“æ„å¦‚ä¸‹ï¼š</p><p><figure class=gallery-image style=flex-grow:267;flex-basis:642px><a href=/2016/12/27/go-slices-usage-and-internals/go-slices-usage-and-internals_slice-1.png data-size=517x193><img src=/2016/12/27/go-slices-usage-and-internals/go-slices-usage-and-internals_slice-1.png width=517 height=193 srcset="/2016/12/27/go-slices-usage-and-internals/go-slices-usage-and-internals_slice-1_hu6eaee86cb225b00d5958a365785f0443_6334_480x0_resize_box_2.png 480w, /2016/12/27/go-slices-usage-and-internals/go-slices-usage-and-internals_slice-1_hu6eaee86cb225b00d5958a365785f0443_6334_1024x0_resize_box_2.png 1024w" loading=lazy></a></figure></p><p>é•¿åº¦æ˜¯åˆ‡ç‰‡å¼•ç”¨çš„å…ƒç´ çš„æ•°é‡ã€‚å®¹é‡æ˜¯åº•å±‚æ•°ç»„ä¸­å…ƒç´ çš„æ•°é‡ï¼ˆä»sliceæŒ‡é’ˆå¼•ç”¨çš„å…ƒç´ å¼€å§‹ï¼‰ã€‚å°†é€šè¿‡ä¸‹é¢å‡ ä¸ªå°ä¾‹å­ï¼Œå°†å¸®åŠ©ä½ ç†è§£é•¿åº¦å’Œå®¹é‡ä¹‹é—´çš„åŒºåˆ«ã€‚</p><p>åœ¨æˆ‘ä»¬åˆ‡ç‰‡æ—¶ï¼Œè§‚å¯Ÿåˆ‡ç‰‡æ•°æ®ç»“æ„ä¸­çš„å˜åŒ–åŠå…¶ä¸åŸºç¡€æ•°ç»„çš„å…³ç³»ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>s</span> = <span style=color:#a6e22e>s</span>[<span style=color:#ae81ff>2</span>:<span style=color:#ae81ff>4</span>]
</code></pre></div><p>!()[https://blog.golang.org/go-slices-usage-and-internals_slice-2.png]</p><p>åˆ‡ç‰‡æ“ä½œä¸ä¼šæ‹·è´å·²æœ‰çš„åˆ‡ç‰‡æ•°æ®ï¼Œå°†åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ‡ç‰‡æŒ‡å‘åŸæ¥çš„æ•°ç»„ã€‚è¿™ä½¿å¾—åˆ‡ç‰‡æ“ä½œä¸æ“ä½œæ•°ç»„ç´¢å¼•ä¸€æ ·é«˜æ•ˆã€‚å› æ­¤ï¼Œä¿®æ”¹é‡æ–°åˆ‡ç‰‡çš„å…ƒç´ ï¼ˆè€Œä¸æ˜¯åˆ‡ç‰‡æœ¬èº«ï¼‰å°†ä¿®æ”¹åŸå§‹åˆ‡ç‰‡çš„å…ƒç´ ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>d</span> <span style=color:#f92672>:=</span> []<span style=color:#66d9ef>byte</span>{<span style=color:#e6db74>&#39;r&#39;</span>, <span style=color:#e6db74>&#39;o&#39;</span>, <span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;d&#39;</span>}
<span style=color:#a6e22e>e</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>d</span>[<span style=color:#ae81ff>2</span>:]
<span style=color:#75715e>// e == []byte{&#39;a&#39;, &#39;d&#39;}
</span><span style=color:#75715e></span><span style=color:#a6e22e>e</span>[<span style=color:#ae81ff>1</span>] = <span style=color:#e6db74>&#39;m&#39;</span>
<span style=color:#75715e>// e == []byte{&#39;a&#39;, &#39;m&#39;}
</span><span style=color:#75715e>// d == []byte{&#39;r&#39;, &#39;o&#39;, &#39;a&#39;, &#39;m&#39;}
</span></code></pre></div><p>ä¹‹å‰æˆ‘ä»¬æŠŠ<code>s</code>åˆ‡ç‰‡æˆé•¿åº¦æ¯”å®¹é‡å°‘çš„åˆ‡ç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é‡æ–°åˆ‡ç‰‡å°†å®ƒé•¿åº¦å¢é•¿å’Œå®¹é‡ä¸€æ ·å¤§(æˆ‘ä¹‹å‰è¿˜çœŸä¸çŸ¥é“èƒ½è¿™ä¹ˆç©ğŸ˜‚)ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>s</span> = <span style=color:#a6e22e>s</span>[:cap(<span style=color:#a6e22e>s</span>)]
</code></pre></div><p>åˆ‡ç‰‡ä¸èƒ½è¶…è¶Šå…¶å®¹é‡ã€‚å°è¯•è¿™æ ·åšä¼šå¯¼è‡´è¿è¡Œæ—¶panicï¼Œå°±åƒåœ¨åˆ‡ç‰‡æˆ–æ•°ç»„çš„è¾¹ç•Œå¤–å»ºç«‹ç´¢å¼•ä¸€æ ·ã€‚ç±»ä¼¼åœ°ï¼Œåˆ‡ç‰‡ä¸èƒ½åœ¨é›¶ä»¥ä¸‹é‡æ–°åˆ‡ç‰‡ä»¥è®¿é—®æ•°ç»„ä¸­çš„æ—©æœŸå…ƒç´ ã€‚</p><h3 id=åˆ‡ç‰‡å¢é•¿æ‹·è´å’Œappendå‡½æ•°>åˆ‡ç‰‡å¢é•¿ï¼ˆæ‹·è´å’Œappendå‡½æ•°ï¼‰</h3><p>ä¸ºäº†å¢åŠ åˆ‡ç‰‡çš„å®¹é‡ï¼Œå¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°çš„è¾ƒå¤§åˆ‡ç‰‡ï¼Œå¹¶å°†åŸå§‹åˆ‡ç‰‡çš„å†…å®¹å¤åˆ¶åˆ°å…¶ä¸­ã€‚è¿™ç§æŠ€æœ¯å°±æ˜¯å…¶ä»–è¯­è¨€çš„åŠ¨æ€æ•°ç»„çš„èƒŒåå®ç°ã€‚ä¸‹ä¸€ä¸ªä¾‹å­é€šè¿‡åˆ¶ä½œä¸€ä¸ªæ–°çš„åˆ‡ç‰‡<code>t</code>ï¼Œå°†<code>s</code>çš„å†…å®¹å¤åˆ¶åˆ°<code>t</code>ï¼Œç„¶åå°†åˆ‡ç‰‡å€¼<code>t</code>åˆ†é…ç»™<code>s</code>æ¥ä½¿<code>s</code>çš„å®¹é‡åŠ å€ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>t</span> <span style=color:#f92672>:=</span> make([]<span style=color:#66d9ef>byte</span>, len(<span style=color:#a6e22e>s</span>), (cap(<span style=color:#a6e22e>s</span>)<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span>) <span style=color:#75715e>// +1 in case cap(s) == 0
</span><span style=color:#75715e></span><span style=color:#66d9ef>for</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>s</span> {
        <span style=color:#a6e22e>t</span>[<span style=color:#a6e22e>i</span>] = <span style=color:#a6e22e>s</span>[<span style=color:#a6e22e>i</span>]
}
<span style=color:#a6e22e>s</span> = <span style=color:#a6e22e>t</span>
</code></pre></div><p>é€šè¿‡å†…ç½®çš„<code>copy</code>å‡½æ•°å¯ä»¥æ›´åŠ å®¹æ˜“çš„å®ç°è¿™ç§å¾ªç¯æ“ä½œã€‚é¡¾åæ€ä¹‰ï¼Œå¤åˆ¶å°†æ•°æ®ä»æºåˆ‡ç‰‡å¤åˆ¶åˆ°ç›®æ ‡åˆ‡ç‰‡ã€‚å®ƒè¿”å›å¤åˆ¶çš„å…ƒç´ æ•°ã€‚</p><p>å¤åˆ¶åŠŸèƒ½æ”¯æŒåœ¨ä¸åŒé•¿åº¦çš„åˆ‡ç‰‡ä¹‹é—´è¿›è¡Œå¤åˆ¶ï¼ˆå®ƒåªä¼šå¤åˆ¶åˆ°è¾ƒå°‘æ•°é‡çš„å…ƒç´ ï¼‰ã€‚æ­¤å¤–ï¼Œå‰¯æœ¬å¯ä»¥å¤„ç†å…±äº«ç›¸åŒåº•å±‚æ•°ç»„çš„æºå’Œç›®æ ‡sliceï¼Œæ­£ç¡®å¤„ç†é‡å sliceã€‚</p><p>ä½¿ç”¨copyï¼Œæˆ‘ä»¬å¯ä»¥ç®€åŒ–ä¸Šé¢çš„ä»£ç ç‰‡æ®µï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>t</span> <span style=color:#f92672>:=</span> make([]<span style=color:#66d9ef>byte</span>, len(<span style=color:#a6e22e>s</span>), (cap(<span style=color:#a6e22e>s</span>)<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span>)
copy(<span style=color:#a6e22e>t</span>, <span style=color:#a6e22e>s</span>)
<span style=color:#a6e22e>s</span> = <span style=color:#a6e22e>t</span>
</code></pre></div><p>å¸¸è§çš„æ“ä½œæ˜¯å°†æ•°æ®é™„åŠ åˆ°åˆ‡ç‰‡çš„æœ«å°¾ã€‚æ­¤å‡½æ•°å°†å­—èŠ‚å…ƒç´ é™„åŠ åˆ°å­—èŠ‚ç‰‡ï¼Œå¦‚æœå¿…è¦ï¼Œå¢é•¿åˆ‡ç‰‡ï¼Œå¹¶è¿”å›æ–°çš„åˆ‡ç‰‡ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>AppendByte</span>(<span style=color:#a6e22e>slice</span> []<span style=color:#66d9ef>byte</span>, <span style=color:#a6e22e>data</span> <span style=color:#f92672>...</span><span style=color:#66d9ef>byte</span>) []<span style=color:#66d9ef>byte</span> {
    <span style=color:#a6e22e>m</span> <span style=color:#f92672>:=</span> len(<span style=color:#a6e22e>slice</span>)
    <span style=color:#a6e22e>n</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>m</span> <span style=color:#f92672>+</span> len(<span style=color:#a6e22e>data</span>)
    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>n</span> &gt; cap(<span style=color:#a6e22e>slice</span>) { <span style=color:#75715e>// if necessary, reallocate
</span><span style=color:#75715e></span>        <span style=color:#75715e>// allocate double what&#39;s needed, for future growth.
</span><span style=color:#75715e></span>        <span style=color:#a6e22e>newSlice</span> <span style=color:#f92672>:=</span> make([]<span style=color:#66d9ef>byte</span>, (<span style=color:#a6e22e>n</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span>)
        copy(<span style=color:#a6e22e>newSlice</span>, <span style=color:#a6e22e>slice</span>)
        <span style=color:#a6e22e>slice</span> = <span style=color:#a6e22e>newSlice</span>
    }
    <span style=color:#a6e22e>slice</span> = <span style=color:#a6e22e>slice</span>[<span style=color:#ae81ff>0</span>:<span style=color:#a6e22e>n</span>]
    copy(<span style=color:#a6e22e>slice</span>[<span style=color:#a6e22e>m</span>:<span style=color:#a6e22e>n</span>], <span style=color:#a6e22e>data</span>)
    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>slice</span>
}
</code></pre></div><p>å¯ä»¥ä½¿ç”¨AppendByteè¿™æ ·ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>p</span> <span style=color:#f92672>:=</span> []<span style=color:#66d9ef>byte</span>{<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>}
<span style=color:#a6e22e>p</span> = <span style=color:#a6e22e>AppendByte</span>(<span style=color:#a6e22e>p</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>13</span>)
<span style=color:#75715e>// p == []byte{2, 3, 5, 7, 11, 13}
</span></code></pre></div><p>åƒAppendByteè¿™æ ·çš„å‡½æ•°å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬æä¾›å¯¹åˆ‡ç‰‡ç”Ÿé•¿æ–¹å¼çš„å®Œå…¨æ§åˆ¶ã€‚æ ¹æ®ç¨‹åºçš„ç‰¹æ€§ï¼Œå¯èƒ½éœ€è¦åˆ†é…æ›´å°æˆ–æ›´å¤§çš„å—ï¼Œæˆ–è€…å¯¹é‡æ–°åˆ†é…çš„å¤§å°è®¾ç½®ä¸Šé™ã€‚</p><p>ä½†æ˜¯å¤§å¤šæ•°ç¨‹åºä¸éœ€è¦å®Œå…¨æ§åˆ¶ï¼Œæ‰€ä»¥Goæä¾›äº†ä¸€ä¸ªå†…ç½®çš„<code>append</code>å‡½æ•°ï¼Œé€‚åˆå¤§å¤šæ•°ç”¨é€”; å‡½æ•°å£°æ˜ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> append(<span style=color:#a6e22e>s</span> []<span style=color:#a6e22e>T</span>, <span style=color:#a6e22e>x</span> <span style=color:#f92672>...</span><span style=color:#a6e22e>T</span>) []<span style=color:#a6e22e>T</span>
</code></pre></div><p><code>append</code>å‡½æ•°å°†å…ƒç´ xé™„åŠ åˆ°åˆ‡ç‰‡çš„æœ«å°¾ï¼Œå¦‚æœéœ€è¦æ›´å¤§çš„å®¹é‡ï¼Œåˆ™å¢é•¿åˆ‡ç‰‡ã€‚</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>a</span> <span style=color:#f92672>:=</span> make([]<span style=color:#66d9ef>int</span>, <span style=color:#ae81ff>1</span>)
<span style=color:#75715e>// a == []int{0}
</span><span style=color:#75715e></span><span style=color:#a6e22e>a</span> = append(<span style=color:#a6e22e>a</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>)
<span style=color:#75715e>// a == []int{0, 1, 2, 3}
</span></code></pre></div><p>è¦å°†ä¸€ä¸ªåˆ‡ç‰‡é™„åŠ åˆ°å¦ä¸€ä¸ªåˆ‡ç‰‡ï¼Œè¯·ä½¿ç”¨&mldr;å°†ç¬¬äºŒä¸ªå‚æ•°å±•å¼€ä¸ºå‚æ•°åˆ—è¡¨ã€‚</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>a</span> <span style=color:#f92672>:=</span> []<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;John&#34;</span>, <span style=color:#e6db74>&#34;Paul&#34;</span>}
<span style=color:#a6e22e>b</span> <span style=color:#f92672>:=</span> []<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;George&#34;</span>, <span style=color:#e6db74>&#34;Ringo&#34;</span>, <span style=color:#e6db74>&#34;Pete&#34;</span>}
<span style=color:#a6e22e>a</span> = append(<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span><span style=color:#f92672>...</span>) <span style=color:#75715e>// equivalent to &#34;append(a, b[0], b[1], b[2])&#34;
</span><span style=color:#75715e>// a == []string{&#34;John&#34;, &#34;Paul&#34;, &#34;George&#34;, &#34;Ringo&#34;, &#34;Pete&#34;}
</span></code></pre></div><p>ç”±äºåˆ‡ç‰‡çš„é›¶å€¼ï¼ˆnilï¼‰çš„è¡Œä¸ºç±»ä¼¼äºé›¶é•¿åº¦åˆ‡ç‰‡ï¼Œå› æ­¤ä½ å¯ä»¥å£°æ˜åˆ‡ç‰‡å˜é‡ï¼Œç„¶ååœ¨å¾ªç¯ä¸­é™„åŠ åˆ‡ç‰‡å˜é‡ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// Filter returns a new slice holding only
</span><span style=color:#75715e>// the elements of s that satisfy f()
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>Filter</span>(<span style=color:#a6e22e>s</span> []<span style=color:#66d9ef>int</span>, <span style=color:#a6e22e>fn</span> <span style=color:#66d9ef>func</span>(<span style=color:#66d9ef>int</span>) <span style=color:#66d9ef>bool</span>) []<span style=color:#66d9ef>int</span> {
    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>p</span> []<span style=color:#66d9ef>int</span> <span style=color:#75715e>// == nil
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>v</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>s</span> {
        <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>fn</span>(<span style=color:#a6e22e>v</span>) {
            <span style=color:#a6e22e>p</span> = append(<span style=color:#a6e22e>p</span>, <span style=color:#a6e22e>v</span>)
        }
    }
    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>p</span>
}
</code></pre></div><h3 id=ä¸€ä¸ªå°é—®é¢˜>ä¸€ä¸ªå°é—®é¢˜</h3><p>å¦‚å‰æ‰€è¿°ï¼Œé‡æ–°åˆ‡ç‰‡åˆ‡ç‰‡ä¸ä¼šç”Ÿæˆåº•å±‚æ•°ç»„çš„å‰¯æœ¬ã€‚å®Œæ•´æ•°ç»„å°†ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°å®ƒä¸å†è¢«å¼•ç”¨ã€‚æœ‰æ—¶å¯èƒ½å¯¼è‡´åªéœ€è¦æ•°ç»„ä¸­ä¸€ç‚¹ç‚¹å†…å®¹ï¼Œä½†æ˜¯æ•´ä¸ªæ•°ç»„éƒ½è¢«ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚
ä¾‹å¦‚ï¼Œæ­¤FindDigitså‡½æ•°å°†æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶æœç´¢ç¬¬ä¸€ç»„è¿ç»­æ•°å­—ï¼Œå°†å…¶ä½œä¸ºæ–°åˆ‡ç‰‡è¿”å›ã€‚</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>digitRegexp</span> = <span style=color:#a6e22e>regexp</span>.<span style=color:#a6e22e>MustCompile</span>(<span style=color:#e6db74>&#34;[0-9]+&#34;</span>)

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>FindDigits</span>(<span style=color:#a6e22e>filename</span> <span style=color:#66d9ef>string</span>) []<span style=color:#66d9ef>byte</span> {
    <span style=color:#a6e22e>b</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ioutil</span>.<span style=color:#a6e22e>ReadFile</span>(<span style=color:#a6e22e>filename</span>)
    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>digitRegexp</span>.<span style=color:#a6e22e>Find</span>(<span style=color:#a6e22e>b</span>)
}
</code></pre></div><p>æ­¤ä»£ç çš„è¡Œä¸ºä¸æœŸæœ›ä¸€æ ·ï¼Œä½†è¿”å›çš„<code>[]byte</code>æŒ‡å‘åŒ…å«æ•´ä¸ªæ–‡ä»¶çš„æ•°ç»„ã€‚å› ä¸ºåˆ‡ç‰‡å¼•ç”¨åŸå§‹æ•°ç»„ï¼Œåªè¦åˆ‡ç‰‡è¢«ä¿ç•™,åƒåœ¾æ”¶é›†å™¨å°±ä¸èƒ½é‡Šæ”¾æ•°ç»„ï¼›æ–‡ä»¶çš„æ•´ä¸ªå†…å®¹ä¿å­˜åœ¨å†…å­˜ä¸­ä½†æœ‰ç”¨çš„åªæœ‰ä¸€ç‚¹ã€‚</p><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†éœ€è¦çš„æ•°æ®å¤åˆ¶åˆ°ä¸€ä¸ªæ–°çš„åˆ‡ç‰‡ï¼Œç„¶åè¿”å›å®ƒï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>CopyDigits</span>(<span style=color:#a6e22e>filename</span> <span style=color:#66d9ef>string</span>) []<span style=color:#66d9ef>byte</span> {
    <span style=color:#a6e22e>b</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ioutil</span>.<span style=color:#a6e22e>ReadFile</span>(<span style=color:#a6e22e>filename</span>)
    <span style=color:#a6e22e>b</span> = <span style=color:#a6e22e>digitRegexp</span>.<span style=color:#a6e22e>Find</span>(<span style=color:#a6e22e>b</span>)
    <span style=color:#a6e22e>c</span> <span style=color:#f92672>:=</span> make([]<span style=color:#66d9ef>byte</span>, len(<span style=color:#a6e22e>b</span>))
    copy(<span style=color:#a6e22e>c</span>, <span style=color:#a6e22e>b</span>)
    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>c</span>
}
</code></pre></div><h3 id=å‚è€ƒ>å‚è€ƒ</h3><p>åŸæ–‡<a class=link href=https://blog.golang.org/go-slices-usage-and-internals target=_blank rel=noopener>Go Slices: usage and internals</a></p></section><footer class=article-footer><section class=article-tags><a href=/tags/golang.html>golang</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-contents--wrapper></aside><div class=disqus-container><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//tomwei7.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener('onColorSchemeChange',a=>{DISQUS&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2016 -
2022 å›´åŸ</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.2.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ul><li><ul><li><a href=#æ•°ç»„>æ•°ç»„</a></li><li><a href=#åˆ‡ç‰‡>åˆ‡ç‰‡</a></li><li><a href=#åˆ‡ç‰‡å†…éƒ¨>åˆ‡ç‰‡å†…éƒ¨</a></li><li><a href=#åˆ‡ç‰‡å¢é•¿æ‹·è´å’Œappendå‡½æ•°>åˆ‡ç‰‡å¢é•¿ï¼ˆæ‹·è´å’Œappendå‡½æ•°ï¼‰</a></li><li><a href=#ä¸€ä¸ªå°é—®é¢˜>ä¸€ä¸ªå°é—®é¢˜</a></li><li><a href=#å‚è€ƒ>å‚è€ƒ</a></li></ul></li></ul></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script></body></html>